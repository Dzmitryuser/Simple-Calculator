(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const u of i.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function c(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();const s={logic:document.querySelector(".operations"),result:document.querySelector(".answer"),errorField:document.querySelector(".error-screen"),setLogicScreen(e){this.logic!==null&&(this.logic.textContent=e.join(""),this.resetErrorScreen())},setResultScreen(e){this.result!==null&&(this.result.textContent=String(e),this.resetErrorScreen())},setErrorScreen(e){this.errorField&&(this.errorField.classList.remove("nodisplay"),this.errorField.textContent=`Ошибка: ${e}`)},resetErrorScreen(){this.errorField&&(this.errorField.classList.add("nodisplay"),this.errorField.textContent="")}},t={logicContent:[],answerContent:0,validateExpression(e){const r=e.join("");if(r.trim()==="")return{isValid:!1,error:"Введите выражение"};if(!/^[\d+\-*/().\s]+$/.test(r))return{isValid:!1,error:"Недопустимые символы"};const n=r.replace(/[^()]/g,"");let c=0;for(const o of n)if(c+=o==="("?1:-1,c<0)break;return c!==0?{isValid:!1,error:"Несбалансированные скобки"}:/^[+*/]/.test(r)?{isValid:!1,error:"Оператор в начале"}:/[+\-*/]$/.test(r)?{isValid:!1,error:"Оператор в конце"}:/([+\-*/]{2,})/.test(r)?{isValid:!1,error:"Два оператора подряд"}:/(\.\d*\.|\.$)/.test(r)?{isValid:!1,error:"Некорректное число"}:/\/\s*0(?!\.)/.test(r)?{isValid:!1,error:"Деление на ноль"}:{isValid:!0}},pressCeButton(){this.logicContent.length=0,this.answerContent=0,s.setLogicScreen(this.logicContent),s.setResultScreen(this.answerContent),s.resetErrorScreen()},pressPercentButton(){const e=this.validateExpression(this.logicContent);if(!e.isValid){s.setErrorScreen(e.error||"Ошибка");return}try{const r=this.logicContent.join(""),n=Function('"use strict"; return ('+r+")")();if(!isFinite(n)){s.setErrorScreen("Деление на ноль");return}this.answerContent=n*100,s.setResultScreen(this.answerContent)}catch{s.setErrorScreen("Что-то пошло не так")}},pressBracketOpenButton(){this.logicContent.push("("),s.setLogicScreen(this.logicContent)},pressBackspaseButton(){this.logicContent.pop(),s.setLogicScreen(this.logicContent)},pressSquareRootButton(){const e=this.validateExpression(this.logicContent);if(!e.isValid){s.setErrorScreen(e.error||"Ошибка");return}try{const r=this.logicContent.join(""),n=Function('"use strict"; return ('+r+")")();if(!isFinite(n)){s.setErrorScreen("Деление на ноль");return}this.answerContent=Math.sqrt(n),s.setResultScreen(this.answerContent)}catch{s.setErrorScreen("Что-то пошло не так")}},pressSquareButton(){const e=this.validateExpression(this.logicContent);if(!e.isValid){s.setErrorScreen(e.error||"Ошибка");return}try{const r=this.logicContent.join(""),n=Function('"use strict"; return ('+r+")")();if(!isFinite(n)){s.setErrorScreen("Деление на ноль");return}this.answerContent=n*n,s.setResultScreen(this.answerContent)}catch{s.setErrorScreen("Что-то пошло не так")}},pressBracketCloseButton(){this.logicContent.push(")"),s.setLogicScreen(this.logicContent)},pressDevideButton(){this.logicContent.push("/"),s.setLogicScreen(this.logicContent)},pressSevenButton(){this.logicContent.push("7"),s.setLogicScreen(this.logicContent)},pressEightButton(){this.logicContent.push("8"),s.setLogicScreen(this.logicContent)},pressNineButton(){this.logicContent.push("9"),s.setLogicScreen(this.logicContent)},pressMultiButton(){this.logicContent.push("*"),s.setLogicScreen(this.logicContent)},pressFourButton(){this.logicContent.push("4"),s.setLogicScreen(this.logicContent)},pressFiveButton(){this.logicContent.push("5"),s.setLogicScreen(this.logicContent)},pressSixButton(){this.logicContent.push("6"),s.setLogicScreen(this.logicContent)},pressMinusButton(){this.logicContent.push("-"),s.setLogicScreen(this.logicContent)},pressOneButton(){this.logicContent.push("1"),s.setLogicScreen(this.logicContent)},pressTwoButton(){this.logicContent.push("2"),s.setLogicScreen(this.logicContent)},pressThreeButton(){this.logicContent.push("3"),s.setLogicScreen(this.logicContent)},pressAddButton(){this.logicContent.push("+"),s.setLogicScreen(this.logicContent)},pressPlusMinusButton(){this.logicContent[0]!=="-"?this.logicContent=["-",...this.logicContent]:this.logicContent=this.logicContent.slice(1),s.setLogicScreen(this.logicContent)},presszeroButton(){this.logicContent.push("0"),s.setLogicScreen(this.logicContent)},pressdotButton(){this.logicContent.push("."),s.setLogicScreen(this.logicContent)},pressequalButton(){const e=this.validateExpression(this.logicContent);if(!e.isValid){s.setErrorScreen(e.error||"Ошибка");return}try{const r=this.logicContent.join(""),n=Function('"use strict"; return ('+r+")")();if(!isFinite(n)){s.setErrorScreen("Деление на ноль");return}this.answerContent=n,s.setResultScreen(this.answerContent)}catch{s.setErrorScreen("Что-то пошло не так")}},calculateLogic(){let e=0;const r=this.validateExpression(this.logicContent);if(!r.isValid){s.setErrorScreen(r.error||"Ошибка");return}try{const n=this.logicContent.join(""),c=Function('"use strict"; return ('+n+")")();if(!isFinite(c)){s.setErrorScreen("Деление на ноль");return}e=c}catch{s.setErrorScreen("Что-то пошло не так")}return e}},l=document.querySelector(".keybord"),a=document.querySelector(".ce"),p=document.querySelector(".percent"),h=document.querySelector(".bracket-open"),g=document.querySelector(".back"),d=document.querySelector(".sq-root"),f=document.querySelector(".sq"),B=document.querySelector(".bracket-close"),S=document.querySelector(".dev"),C=document.querySelector(".seven"),y=document.querySelector(".eight"),m=document.querySelector(".nine"),q=document.querySelector(".multi"),k=document.querySelector(".four"),E=document.querySelector(".five"),L=document.querySelector(".six"),F=document.querySelector(".minus"),x=document.querySelector(".one"),w=document.querySelector(".two"),b=document.querySelector(".three"),V=document.querySelector(".add"),O=document.querySelector(".plus-minus"),M=document.querySelector(".zero"),P=document.querySelector(".dot"),R=document.querySelector(".equal");l&&l.addEventListener("click",e=>{e.target===a?t.pressCeButton():e.target===p?t.pressPercentButton():e.target===h?t.pressBracketOpenButton():e.target===g?t.pressBackspaseButton():e.target===d?t.pressSquareRootButton():e.target===f?t.pressSquareButton():e.target===B?t.pressBracketCloseButton():e.target===S?t.pressDevideButton():e.target===C?t.pressSevenButton():e.target===y?t.pressEightButton():e.target===m?t.pressNineButton():e.target===q?t.pressMultiButton():e.target===k?t.pressFourButton():e.target===E?t.pressFiveButton():e.target===L?t.pressSixButton():e.target===F?t.pressMinusButton():e.target===x?t.pressOneButton():e.target===w?t.pressTwoButton():e.target===b?t.pressThreeButton():e.target===V?t.pressAddButton():e.target===O?t.pressPlusMinusButton():e.target===M?t.presszeroButton():e.target===P?t.pressdotButton():e.target===R&&t.pressequalButton()});document.addEventListener("keydown",e=>{e.key==="7"?t.pressSevenButton():e.key==="8"?t.pressEightButton():e.key==="9"?t.pressNineButton():e.key==="4"?t.pressFourButton():e.key==="5"?t.pressFiveButton():e.key==="6"?t.pressSixButton():e.key==="1"?t.pressOneButton():e.key==="2"?t.pressTwoButton():e.key==="3"?t.pressThreeButton():e.key==="0"?t.presszeroButton():e.key==="+"?t.pressAddButton():e.key==="-"?t.pressMinusButton():e.key==="*"?t.pressMultiButton():e.key==="/"?t.pressDevideButton():e.key==="Enter"?t.pressequalButton():e.key==="Escape"?t.pressCeButton():e.key==="Backspace"?t.pressBackspaseButton():e.key===")"?t.pressBracketCloseButton():e.key==="("?t.pressBracketOpenButton():e.key==="%"&&t.pressPercentButton()});
